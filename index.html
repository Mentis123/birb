<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Birb Flight Lab</title>
    <meta
      name="description"
      content="Three.js playground for experimenting with gliding capsules."
    />
    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        background: radial-gradient(circle at top, #1f2945, #0b0d17 65%);
        color: #f3f4f8;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      header {
        padding: 1.5rem;
        text-align: center;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        font-size: 0.85rem;
        opacity: 0.75;
      }

      canvas {
        flex: 1;
        width: 100vw;
        height: 100vh;
        display: block;
      }

      footer {
        position: absolute;
        inset: auto 0 1.5rem;
        text-align: center;
        font-size: 0.75rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        pointer-events: none;
        opacity: 0.45;
      }
    </style>
  </head>
  <body>
    <header>Birb Flight Lab</header>
    <canvas id="scene"></canvas>
    <footer>Gently gliding in progressâ€¦</footer>

    <script type="module">
      import * as THREE from "https://unpkg.com/three@0.161.0/build/three.module.js";
      import { OrbitControls } from "https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js";

      const canvas = document.querySelector("#scene");
      const renderer = new THREE.WebGLRenderer({
        canvas,
        antialias: true,
      });
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
      renderer.outputColorSpace = THREE.SRGBColorSpace;

      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x070b16);

      const camera = new THREE.PerspectiveCamera(
        60,
        window.innerWidth / window.innerHeight,
        0.1,
        100
      );
      camera.position.set(2.5, 1.6, 3.4);

      const controls = new OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.08;
      controls.target.set(0, 0.5, 0);

      const ambientLight = new THREE.AmbientLight(0xffffff, 0.65);
      scene.add(ambientLight);

      const fillLight = new THREE.DirectionalLight(0x8fb8ff, 0.6);
      fillLight.position.set(2, 3, 2);
      scene.add(fillLight);

      const rimLight = new THREE.DirectionalLight(0xffb38a, 0.3);
      rimLight.position.set(-2, 2, -1);
      scene.add(rimLight);

      const capsuleGeometry = new THREE.CapsuleGeometry(0.45, 1.3, 24, 48);
      const capsuleMaterial = new THREE.MeshStandardMaterial({
        color: 0x9fd8ff,
        metalness: 0.25,
        roughness: 0.35,
        emissive: 0x112b44,
        emissiveIntensity: 0.1,
      });
      const capsule = new THREE.Mesh(capsuleGeometry, capsuleMaterial);
      capsule.castShadow = true;
      scene.add(capsule);

      const trailGeometry = new THREE.TorusGeometry(1.8, 0.02, 16, 100);
      const trailMaterial = new THREE.MeshBasicMaterial({
        color: 0x274782,
        transparent: true,
        opacity: 0.35,
      });
      const glideTrail = new THREE.Mesh(trailGeometry, trailMaterial);
      glideTrail.rotation.x = Math.PI / 2;
      scene.add(glideTrail);

      const clock = new THREE.Clock();

      function resizeRenderer() {
        const width = window.innerWidth;
        const height = window.innerHeight;
        const canvasPixelWidth = renderer.domElement.width;
        const canvasPixelHeight = renderer.domElement.height;

        if (canvasPixelWidth !== width || canvasPixelHeight !== height) {
          renderer.setSize(width, height, false);
          camera.aspect = width / height;
          camera.updateProjectionMatrix();
        }
      }

      window.addEventListener("resize", resizeRenderer);
      resizeRenderer();

      function animate() {
        requestAnimationFrame(animate);

        const elapsed = clock.getElapsedTime();
        capsule.rotation.x = Math.sin(elapsed * 0.5) * 0.35;
        capsule.rotation.y += 0.01;
        capsule.position.y = Math.sin(elapsed * 0.8) * 0.12;
        capsule.position.x = Math.cos(elapsed * 0.4) * 0.05;

        glideTrail.rotation.z += 0.0015;

        controls.update();
        renderer.render(scene, camera);
      }

      animate();
    </script>
  </body>
</html>
